# 使用说明

> `重要`: 使用须知为必读, **如果你不看就请不要浪费彼此的时间**。

## 1.使用须知

### 1.1.播放器说明

- `没有完美`的播放器
- 如果有画面`没声音` - 一般为没有声轨
- 如果`黑屏`有声音 - 一般为播放器不支持H265[HEVC]
- 播放器选择需考虑格式兼容性，如 h264 与 h265 的差异
- 如果`播放失败`, 建议切换播放器或者调用系统播放器
    - windows: `potplayer` `vlc` `mpv`
    - macos: `iina` `vlc` `mpv`
    - windows: `vlc` `mpv`

### 1.2.首次使用

首次使用请详细`阅读用户协议`; 开始使用软件则视为同意协议, 如不同意请立即停止使用。

![用户协议](/guide/usage/disclaimer.png)

### 1.3.常见问题

| 序号   |                           问题                |                            解决方法                            |
| :---: | -------------------------------------------- | ------------------------------------------------------------ |
| 1     | 如何配置数据源                                  | 软件`不提供任何数据源`, 所有数据源需用户自行负责, 自己确认数据有效性(别什么都怪软件)                      |
| 2     | 1.打开软件白屏<br>2.打开软件无界面但后台有进程<br>3.打开软件报错提示`sonic boom is not ready yed`                           | 1.确认只打开一次软件(含新老版), 9978端口没被占用(开发环境5173端口也不能被占用)<br>2.`结束所有进程`, `删除数据库目录`, 重启软件(`不要再导入你的数据`[里面有脏数据, 严格按照数据要求])      |
| 3     | 数据导入后但是数据没有变化                        | 1.手动点击尝试刷新; <br>2.尝试重启软件; <br>3.确认数据没问题重新导入尝试    |
| 4     | 软件加载数据源后, T3-Drpy任何数据源都无法显示内容   | 1.可能与其他软件冲突导致子进程无法启动, `尝试重启电脑`; <br>2.部分操作系统网络请求慢(PD虚拟机基本都存在该问题), `调整全局超时时间`(如果源里写了超时时间则改源) <br>3.使用非js接口的数据<br>4.回退`3.3.7`版本   |
| 5     | 部分视频无法播放                                | 1.去广逻辑冲突, `关闭去广功能`<br>2.播放器无法解码, 尝试`切换播放器`或`调用系统播放器`<br>3.预加载冲突(如动态链接时效性), `关闭预加载功能`<br>4.视频格式为`mkv`时兼容性较差, 尝试`调用系统播放器`<br>5.uc｜夸克｜阿里等网盘兼容性较差, 无解<br>6.磁力解析资源能力较差, 无解        |
| 6     | 数据导入失败                                   | 1.确保`网络正常`请求数据时长未超过超时时间; <br>2.导入数据不应被加密, `加密不支持`; <br>3.数据应按数据库`字段类型, 字段长度, 字段名`  |
| 7     | 提示数据源格式化剧集错误                         | 1.数据源故障, `换源`; <br>2.子线程冲突, `重启软件`                                                |
| 8     | 搜索                                          | 1.建议将几个常用源组合成搜索, `不建议全局搜索`; <br>2.数据返回与关键词无关, 说明源站乱返回, `关闭该源搜索`或`开启搜索过滤`; <br>3.数据死循环,某个源一直返回几个相同数据或一直返回数据, `关闭该源搜索`; <br>4.不建议在`搜索未完成之前进行点击`操作;<br>5.搜索中`请勿上下滚动`会导致数据加载爆炸 |

## 2.主程序

### 2.1.布局
![分布](/guide/usage/main-layout.png)

- ①:侧边菜单 [`影视` `电视` `网盘` `解析` `时刻`]
- ②:顶部操作栏
    - 历史导航 [`前进` `后退` `刷新`]
    - 搜索栏（仅打开 `影视` `电视` `解析` 存在）
    - 播放内容 (仅打开 `播放程序` 存在)
    - 功能区 [`赞助` `多语言` `主题` `实验室` `设置` `置顶`]
    - 系统操作区 [`最小化` `放大` `关闭`] (仅 `window` `linux` 存在)
- ③:主内容

### 2.2.影视
![分布-影视](/guide/usage/mian-site.png)

#### 2.2.1.功能
- ①:数据源搜索-输入关键词可快速定位数据源
- ②:数据源导航-预览`激活`数据源, 点击可切换数据源
- ③:数据源分类-点击切换分类
- ④:数据源筛选-点击会增加筛选区域可选择细分领域数据
- ⑤:数据源列表-点击可播放视频
- ⑥:节目搜索-输入关键词可搜索数据
    - 支持`组内` `本站` `全站`搜索
    - 当为选择数据源时不触发搜索
    - 不建议全局搜索或组内搜索(当分组数据源较多时)

#### 2.2.2.常见问题
| 序号   |                           问题                |                            解决方法                            |
| ----- | :-------------------------------------------- | :------------------------------------------------------------ |
| 1     | 暂无数据, 请前往 [设置->影视配置] 配置数据         | 需要选择一个[左侧数据源导航栏]数据源或者前往[设置->影视配置]设置默认数据。`[需要一个数据源来显示数据]`                         |
| 2     | 设置分类异常, 请前往设置检查源分类后尝试手动刷新     | 尝试点击刷新重新拉取数据。`[大概率为数据源失效; 网络请求超时; 部分数据源可能需要授权等]`                         |
| 3     | 网络请求失败, 请尝试手动刷新                      | 尝试点击刷新重新拉取数据, 或切换数据分类`[当前分类或筛选无数据]`, 增加全局网络请求超时时间`[可能网络延迟]`                         |
| 4     | 人家是有底线的                                  | 数据加载完了`[无更多数据]`                              |
| 5     | 哎呀, 出了点差错                                | 1.数据类型不对`[手动修改]`; <br>2.尝试刷新或者重启软件`[数据处理错误]`;                          |
| 6     | 图片不显示                                     | 1.`[一般为数据源返回没有vod_pic字段]`; <br> 2.`[可能为图片需要代理]`; <br> 3.`[极少可能为网络问题]`                         |


### 2.3.电视
![分布-电视](/guide/usage/main-iptv.png)

#### 2.3.1.功能
- ①:数据源搜索-输入关键词可快速定位数据源
- ②:数据源导航-预览`激活`数据源, 点击可切换数据源
- ③:数据源分类-点击切换分类
- ④:数据源列表-点击可播放视频
    - `ip标识` `延迟` 需要全局设置中开启[仅参考-数据不一定准确]
    - 台标优先级`[节目自带 -> 数据源配置 -> 全局 -> 失败默认图标]`
    - 全局设置开启预览图, 则用预览图代替台标`[需要ffmpeg环境]`
    - 右键
        - 复制当前选择频道地址
        - 删除当前频道
- ⑤:节目搜索-输入关键词可搜索数据

#### 2.3.2.常见问题
| 序号   |                           问题                |                            解决方法                            |
| ----- | :-------------------------------------------- | :------------------------------------------------------------ |
| 1     | 暂无数据, 请前往 [设置->电视配置] 配置数据         | 需要选择一个[左侧数据源导航栏]数据源或者前往[设置->电视配置]设置默认数据。`[需要一个数据源来显示数据]`                         |
| 2     | 人家是有底线的                                  | 数据加载完了`[无更多数据]`                                       |
| 3     | 哎呀, 出了点差错                                | 尝试刷新或者重启软件`[一般为数据处理错误]`                          |
| 4     | 未选中数据源, 为何仍有频道                        | 说明之前成功触发过数据源, 但后来又点击了一个数据源但他加载失败了`[频道和数据源非强相关]`                         |
| 5     | 搜索无数据                                      | 触发搜索前`必须选择一个数据源`, 因为要匹配分组                      |

### 2.4.网盘
![分布-网盘](/guide/usage/main-drive.png)

#### 2.4.1.功能
- ①:数据源搜索-输入关键词可快速定位数据源
- ②:数据源导航-预览`激活`数据源, 点击可切换数据源
- ③:数据源分类-点击切换面包屑网盘路径
- ④:数据源列表-点击可播放视频

#### 2.4.2.常见问题
| 序号   |                           问题                |                            解决方法                            |
| ----- | :-------------------------------------------- | :------------------------------------------------------------ |
| 1     | 暂无数据, 请前往 [设置->网盘配置] 配置数据         | 需要选择一个[左侧数据源导航栏]数据源或者前往[设置->网盘配置]设置默认数据。`[需要一个数据源来显示数据]`                         |
| 2     | 人家是有底线的                                  | 数据加载完了`[无更多数据]`                              |
| 3     | 网络请求错误, 可尝试重试                         | 大概率为需要密码授权`[该路径可能需要某些权限]`                          |

### 2.5.解析
![分布-解析](/guide/usage/main-analyze.png)
![分布-解析-搜索](/guide/usage/main-analyze-search.png)
#### 2.5.1.功能
- ①:数据源搜索-输入关键词可快速定位数据源
- ②:数据源导航-预览`激活`数据源, 点击可切换数据源
- ③:顶部操作栏
    - 原始按钮-点击可打开当前播放地址的页面iframe(当前播放时存在)
    - 分享按钮-点击分享当前数据`扫码` `复制`(当前播放时存在)
    - 历史按钮-点击查看历史数据`可删除`
    - 清除按钮-点击清除当前播放数据(当前播放时存在)
- ④:播放-需选中接口+输入地址
- ⑤:节目搜索-输入关键词可搜索数据
- ⑥:高级搜索栏
    - 支持xx@快捷选择搜索站
    - 清空-清除选中站点及关键词
    - x-关闭搜索
    - 直接回车则使用默认站点搜索
- ⑦:iframe嵌套加载
    - `播放` `前进` `后退` `刷新`(播放按钮应该在加载具体视频具体剧集后触发)
    - x-关闭iframe

#### 2.5.2.常见问题
| 序号   |                           问题                |                            解决方法                            |
| ----- | :-------------------------------------------- | :------------------------------------------------------------ |
| 1     | 选择解析接口或输入需要解析的地址                   | 需要选择一个[左侧数据源导航栏]数据源或者前往[设置->解析配置]设置默认数据。`[需要一个数据源来显示加载数据]` |
| 2     | 加载失败, 请尝试切换其他接口                      | 尝试切换数据源`[当前数据源接口无法解析出数据或嗅探失败]`                              |
| 3     | 无效的解析接口                                  | 尝试切换数据源`[当前数据源不支持]`                          |
| 4     | 人家是有底线的                                  | 历史数据加载完了`[无更多数据]`                          |
| 5     | 哎呀, 出了点差错                                | 尝试刷新或者重启软件`[一般为历史数据处理错误]`                          |

### 2.6.时刻
![分布-时刻](/guide/usage/main-moment.png)

#### 2.6.1.功能
- ①:数据源导航-切换`收藏`或`历史`
    - 仅限影视数据展示
    - 历史按`[今天>七天内->更久以前]`排序
- ②:数据源列表-点击可播放视频
    - 鼠标停留-支持删除单个记录

#### 2.6.2.常见问题
| 序号   |                           问题                |                            解决方法                            |
| ----- | :-------------------------------------------- | :------------------------------------------------------------ |
| 1     | 人家是有底线的                                  | 数据加载完了`[无更多数据]`                                       |
| 3     | 该源应该被删除了哦                               | 一般为数据导入多次, 源标识不同`[数据关联失败]`                      |
| 3     | 1.视频播放中为视频进度不变<br> 2.数据没有新增       | 数据不会实时刷新`[需手动刷新]`                                   |
| 4     | 时刻页访问报错, 影视页访问正常                    | 大概率为数据源问题, `[一级和二级返回的vod_id不一致导致]`             |


### 2.7.配置
![分布-配置-基础](/guide/usage/main-setting-1.png)

#### 2.7.1.功能-基础
- 主题: 支持`浅色` `深色` `更随系统`
- 老板键: 一键隐藏软件
- 超时: 全局网络请求超时时间, 单位: 毫秒
- 影视
    - 热榜: 搜索栏展示热搜数据-`酷云` `云合` `豆瓣` `移动爱家`
    - 搜索: 设置默认搜索分组-`本站` `组内` `聚合`
    - 过滤: 针对搜索数据进行二次过滤-`开` `关`(部分数据站点乱返回数据)
- 电视
    - ip标识: 频道展示ip标识(仅参考)
    - 延迟: 频道展示延迟标识(仅参考)
    - 缩略图: 全局频道预览图(需按照ffmpeg)
    - 节目: 全局电子节目单
    - 台标: 全局台标
- 播放器
    - web播放器支持 `xgplayer` `artplayer` `dplayer` `nplayer`
    - 自定义播放器则调用系统安装软件(需填写安装路径)
    - 嗅探
        - pie方案则为调用软件本身
        - 第三方方案则调用第三方接口(需填写接口地址)
    - 弹幕
        - 接口: 请求数据的地址
        - 返回字段: 数据请求后返回的json数据中具体弹幕字段
        - 线路: 只有为播放线路是填写部分才会触发加载
        - 键值映射: 键值对映射在返回字段中的数据下标-`时间` `颜色` `模式` `内容`
- 安全
    - 网络代理: 打开系统设置中的代理配置页面(需修改系统代理-重启软件生效)
    - 用户代理: ua, 软件全局请求头
    - dns: 设置软件网络请求的安全doh
- 权限
    - 自启动: pc开机时是否一起启动软件
    - 窗口位置: 关闭软件时会记录当前位置和大小，重启软件时按记录恢复
    - 调试: 数据会上报 `pagespy`, 嗅探会弹页面
- 其他
    - 恢复出厂: 恢复软件默认配置
    - 数据管理:
        - 快捷配置
            - drpy: 该配置项为`drpy-js0格式`
            - tvbox: 支持`tvbox` `hipy` `本地包` 格式中的部分数据
            - catvod: 支持`nodejs`运行时, 打包后失效(默认地址为`http://127.0.0.1:3006/config`)
        - 数据导入: 软件本身数据
        - 数据导出: 已json格式导出软件本身数据(支持不同类型数据)
        - 数据清理: 清理数据(支持不同类型数据)
        - 同步盘: 用于将数据同步到远端(仅 webdev 格式)
            - 开启自动同步, 将 5 分钟同步一次数据
            - 同步数据到账号: 将本地数据同步到账号
            - 云端数据覆盖本地: 将云端数据覆盖本地数据
    - 检查更新: 检查软件是否存在最新版本
        - 仅window支持在线更新, linux 和 mac 自行前往 github 下载
            - 下载过程中请勿操作其他操作, 请停留在当前页面(**重要**)
        - 确保网络与github连通性(**重要**)
    - 用户协议: 查看用户协议


![分布-配置-数据源](/guide/usage/main-setting-2.png)

#### 2.7.2.功能-数据源
> 包含 `影视配置` `电视配置` `解析配置` `网盘配置`

- 添加: 按数据要求填写数据
- 启用: 快速启用数据源(支持多选或单个)
- 禁用: 禁用禁用数据源(支持多选或单个)
- 删除: 删除数据源(支持多选或单个)
- 搜索: 输入关键词快速检索出需要的数据
- 默认: 设置选中数据数据源为默认加载项
- 标识: 解析标识, 只有线路匹配才会触发解析(`仅解析配置存在`)
- 检测: 仅支持单次检测, `批量会窜数据`(`仅影视配置存在`)
    - 判断有没有返回分类[`仅参考, 不作为实际有效判断`]
    - 不会保存数据, 检查后有数据则改为启用否则改为不启用

### 2.8.实验室

#### 2.8.1.功能-数据编码
![分布-实验室-数据编码](/guide/usage/main-lab-dataCrypto.png)

- 加密解密: `RSA` `RC4` `AES` `DES` `3DES` `Rabbit` `RabbitLegacy` `SM4` 
- 哈希计算: 
    - hash: `md5-16` `md5-32` `sha1` `sha224` `sha256` `sha3` `sha384` `sha512` `ripemd160`
    - hmac: `md5-16` `md5-32` `sha1` `sha224` `sha256` `sha3` `sha384` `sha512` `ripemd160`
- 编码转化: `html` `unicode` `base64` `url` `hex` `gzip`

#### 2.8.2.功能-人工智脑
![分布-实验室-人工智脑](/guide/usage/main-lab-aiBrain.png)

> 调用openai协助完成问题回答, [点我前往查看详细用法](/editSource/ai-brain.html)

- ①: OpenAI参数-填写`服务器` `密钥` `模型`
    - [OpenAI 官方的APIKey](https://platform.openai.com/api-keys)
    - [免费的 APIKey](https://github.com/chatanywhere/GPT_API_free)
- ②: 指令库
    - 问答: 解答简单问题
    - 筛选: 筛选出符合要求的数据(需输入代码片段)
    - css选择器: 从网页中提取css选择器(需输入代码片段)

#### 2.8.3.功能-写源工具
![分布-实验室-写源工具](/guide/usage/main-lab-jsEdit.png)

> 用于调试js数据源, [点我前往查看详细用法](/editSource/js-edit.html)

#### 2.8.4.功能-静态筛选
![分布-实验室-静态筛选](/guide/usage/main-lab-staticFilter.png)

> 用于生成js静态筛选

#### 2.8.5.功能-嗅探播放
![分布-实验室-嗅探播放](/guide/usage/main-lab-snifferPlay.png)

- ①: 嗅探测试-填写`嗅探地址` `初始参数` `运行参数` `正则匹配` `正则排除`
- ②: 播放测试-填写`播放链接` `请求头` `媒体类型`
    - 请求头(实验性)
    - 媒体类型为`Auto`时程序自行尝试获取类型


#### 2.8.6.功能-插件中心
![分布-实验室-插件中心](/guide/usage/main-lab-pluginCenter.png)

> 用于扩展软件的不足

- ①: 安装(操作步骤如下): 安装`node_modules` 和 注册插件信息
    - 1. 下载插件并放置插件根目录文件夹
    - 2. 输入插件文件夹名称
    - 3. 点击安装
- ②: 卸载: 删除`node_modules` `package-lock.json` 和 注销插件信息
- ③: 管理
    - 启动服务: 运行项目-[`system组件存在`]
        - 退出软件时如插件处于运行状态-下次则随软件启动
        - 如状态显示运行但实际无法访问-请手动停止后重新启动
    - 停止服务: 停止项目-[`system组件存在`]
    - 开发者工具: 打开开发者工具-[`ui组件存在`]

## 3.播放程序

#### 3.1.布局
![播放-布局](/guide/usage/play-layout.png)

- ①: 点击显示主程序
- ②: 视频名称
- ③: 功能区 [赞助 多语言 主题 置顶]

#### 3.2.功能-影视
![播放-影视](/guide/usage/play-site.png)

- ①: 简介-查看当前播节目介绍
- ②: 数据栏
    - 收藏: 点击添加到收藏
    - 下载: 点击后支持将当前选集数据展示(支持复制所有或当前播放链接)
        - 复制当前链接: 只要当前在播放原则上都能缓存 [`如果链接没限制的话, 如时间戳限制`]
        - 复制选中: 复制源数据格式, 不解析不嗅探 [`需要嗅探解析等没有意义`]
    - 分享: 点击分享当前数据
    - 更多
        - 设置: 开关全局生效, 进度时间仅当前历史生效
            - 跳进度: 跳过开始时间和结束时间
            - 续下集: 打开时播放完毕时自动播放下集
            - 预加载: 播放结束前30s提前获取下一集播放链接和弹幕数据
            - 过广告: 仅支持部分m3u8(会增加起播时间) [`下个视频生效`]
- ③: 选集
    - 解析: 仅匹配到全局设置的解析标识时才显示
    - 排序: 支持正序和倒序
    - 线路: 点击切换不同线路
    - 集数: 点击切换不同集数
- ④: 猜你喜欢-点击搜索该数据并切换数据源

#### 3.3.功能-电视
![播放-网盘](/guide/usage/play-iptv.png)

- ①: 节目-查看当前播放频道的电子节目单
- ②: 频道-查看其他频道数据
    - 分类切换则加载不同分组数据
    - 点击切换播放数据源

#### 3.4.功能-网盘
![播放-网盘](/guide/usage/play-drive.png)

- ①: 点击切换播放数据源

## 4.托盘/菜单

| 平台   | 显示    |                            功能                               | 截图 |
| :---: | :-----: | ------------------------------------------------------------ |---|
| mac   | 菜单     | 1.`zyfun`-关于:查看版本号;重启:重新打开软件;退出:退出程序<br>2.`帮助`-打开控制台:打开开发者工具;访问Github:调用默认浏览器打开代码仓库;打开数据目录:调用系统窗口打开数据目录           |![mac-menu](/guide/usage/mac-menu.png)|
| linux | 托盘(右键)     | 1.`打开zyfun`:显示窗口<br>2.`打开数据目录`:调用系统窗口打开数据目录<br>3.`关于`:查看版本号<br>4.`退出`:退出程序  |![linux-tray](/guide/usage/linux-tray.png)|
| win   | 托盘(右键)     | 1.`打开zyfun`:显示窗口<br>2.`打开数据目录`:调用系统窗口打开数据目录<br>3.`关于`:查看版本号<br>4.`退出`:退出程序  |![win-tray](/guide/usage/win-tray.png)|
